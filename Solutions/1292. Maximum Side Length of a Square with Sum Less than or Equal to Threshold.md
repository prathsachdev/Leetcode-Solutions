<!-- problem:start -->

# [1292. Maximum Side Length of a Square with Sum Less than or Equal to Threshold](https://leetcode.com/problems/maximum-side-length-of-a-square-with-sum-less-than-or-equal-to-threshold)

## Description

<!-- description:start -->

<p>Given a <code>m x n</code> matrix <code>mat</code> and an integer <code>threshold</code>, return <em>the maximum side-length of a square with a sum less than or equal to </em><code>threshold</code><em> or return </em><code>0</code><em> if there is no such square</em>.</p>
<p>&nbsp;</p>

<p><strong class="example">Example 1:</strong></p>
<img alt="" src="https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/1200-1299/1292.Maximum%20Side%20Length%20of%20a%20Square%20with%20Sum%20Less%20than%20or%20Equal%20to%20Threshold/images/e1.png" style="width: 335px; height: 186px;" />
<pre>
<strong>Input:</strong> mat = [[1,1,3,2,4,3,2],[1,1,3,2,4,3,2],[1,1,3,2,4,3,2]], threshold = 4
<strong>Output:</strong> 2
<strong>Explanation:</strong> The maximum side length of square with sum less than 4 is 2 as shown.
</pre>

<p><strong class="example">Example 2:</strong></p>
<pre>
<strong>Input:</strong> mat = [[2,2,2,2,2],[2,2,2,2,2],[2,2,2,2,2],[2,2,2,2,2],[2,2,2,2,2]], threshold = 1
<strong>Output:</strong> 0
</pre>
<p>&nbsp;</p>

<p><strong>Constraints:</strong></p>
<ul>
    <li><code>m == mat.length</code></li>
    <li><code>n == mat[i].length</code></li>
    <li><code>1 &lt;= m, n &lt;= 300</code></li>
    <li><code>0 &lt;= mat[i][j] &lt;= 10<sup>4</sup></code></li>
    <li><code>0 &lt;= threshold &lt;= 10<sup>5</sup></code></li>
</ul>

<!-- description:end -->

## Solutions

<!-- solution:start -->

### **Approach 1: Prefix Sum**

We can precompute a 2D prefix sum array $prefix$, where $prefix[i][j]$ represents the sum of elements in the matrix $mat$ from $(0, 0)$ to $(i, j)$. With this, we can calculate the sum of elements in any square region in $O(1)$ time.

The time complexity is $O(m \times n \times \min(m, n))$, and the space complexity is $O(m \times n)$.

<p><strong>Time Complexity:</strong> $O(m \times n \times \min(m, n))$</p>
<p><strong>Space Complexity:</strong> $O(m \times n)$</p>

<!-- tabs:start -->

```java
class Solution {
    private int m;
    private int n;
    private int[][] prefix;
    
    public int subMatrixSum(int i, int j, int r2, int c2) {
        int sum = prefix[r2][c2];
        
        if (i > 0) {
            sum -= prefix[i - 1][c2];
        }
        
        if (j > 0) {
            sum -= prefix[r2][j - 1];
        }
        
        if (i > 0 && j > 0) {
            sum += prefix[i - 1][j - 1];
        }
        
        return sum;
    }
    
    public int maxSideLength(int[][] mat, int threshold) {
        m = mat.length;
        n = mat[0].length;
        
        // Compute prefixSum of 2D array
        prefix = new int[m][n];
        
        for (int i = 0; i < m; ++i) {
            for (int j = 0; j < n; ++j) {
                if (i > 0) {
                    prefix[i][j] += prefix[i - 1][j];
                }
                
                if (j > 0) {
                    prefix[i][j] += prefix[i][j - 1];
                }
                
                if (i > 0 && j > 0) {
                    prefix[i][j] -= prefix[i - 1][j - 1];
                }
                
                prefix[i][j] += mat[i][j];
            }
        }
        
        int ans = 0;
        
        for (int i = 0; i < m; ++i) {
            for (int j = 0; j < n; ++j) {
                int maxSide = Math.min(m - i, n - j);
                
                for (int offset = 0; offset < maxSide; ++offset) {
                    int r2 = i + offset;
                    int c2 = j + offset;
                    
                    if (subMatrixSum(i, j, r2, c2) <= threshold) {
                        ans = Math.max(ans, offset + 1);
                    } else {
                        break;
                    }
                }
            }
        }
        
        return ans;
    }
}
```

<!-- tabs:end -->

<!-- solution:end -->

<!-- problem:end -->